{% extends "layout.html" %}
{% block title %}Gösterge Paneli · İNFİNİTEX YAPI{% endblock %}

{% block content %}

<h1>Gösterge Paneli</h1>
<p class="page-subtitle">
    Şantiyeler, çalışanlar ve iş güvenliği denetimlerinin genel görünümü.
</p>

<div class="grid">
    <div class="card">
        <h2>Aktif Şantiye Sayısı</h2>
        <p class="metric">{{ sites|length }}</p>
    </div>
    <div class="card">
        <h2>Toplam Çalışan</h2>
        <p class="metric">{{ workers|length }}</p>
    </div>
    <div class="card">
        <h2>Denetim Kaydı</h2>
        <p class="metric">{{ inspections|length }}</p>
    </div>
    <div class="card">
        <h2>Genel Risk Özeti</h2>
        <p>Toplam: {{ risk_summary.total }}</p>
        <p>Düşük: {{ risk_summary.low }}</p>
        <p>Orta: {{ risk_summary.medium }}</p>
        <p>Yüksek: {{ risk_summary.high }}</p>
    </div>
</div>

<h2 style="margin-bottom: 8px;">Şantiyelere Göre Risk Analizi</h2>

<table>
    <thead>
    <tr>
        <th>Şantiye</th>
        <th>Denetim Sayısı</th>
        <th>Düşük</th>
        <th>Orta</th>
        <th>Yüksek</th>
        <th>Ortalama Risk Skoru</th>
        <th>Durum</th>
    </tr>
    </thead>
    <tbody>
    {% for r in site_risks %}
        <tr>
            <td>{{ r.site_name }}</td>
            <td>{{ r.total }}</td>
            <td>{{ r.low }}</td>
            <td>{{ r.medium }}</td>
            <td>{{ r.high }}</td>
            <td>{{ r.score }}</td>
            <td>{{ r.label }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>

{% endblock %}
